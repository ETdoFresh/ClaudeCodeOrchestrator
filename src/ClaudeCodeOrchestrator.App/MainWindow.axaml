<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:dock="using:Dock.Avalonia.Controls"
        xmlns:vm="using:ClaudeCodeOrchestrator.App.ViewModels"
        xmlns:dockVm="using:ClaudeCodeOrchestrator.App.ViewModels.Docking"
        xmlns:panels="using:ClaudeCodeOrchestrator.App.Views.Panels"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        x:Class="ClaudeCodeOrchestrator.App.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="{Binding WindowTitle}"
        Width="1200" Height="800"
        MinWidth="800" MinHeight="600"
        Background="#1E1E1E">

    <Window.DataTemplates>
        <!-- File Browser -->
        <DataTemplate DataType="{x:Type dockVm:FileBrowserViewModel}">
            <panels:FileBrowserView />
        </DataTemplate>

        <!-- Session Document -->
        <DataTemplate DataType="{x:Type dockVm:SessionDocumentViewModel}">
            <panels:SessionView />
        </DataTemplate>

        <!-- Worktrees -->
        <DataTemplate DataType="{x:Type dockVm:WorktreesViewModel}">
            <panels:WorktreesView />
        </DataTemplate>

        <!-- File Document -->
        <DataTemplate DataType="{x:Type dockVm:FileDocumentViewModel}">
            <panels:FileView />
        </DataTemplate>

        <!-- Settings -->
        <DataTemplate DataType="{x:Type dockVm:SettingsViewModel}">
            <panels:SettingsView />
        </DataTemplate>
    </Window.DataTemplates>

    <Grid RowDefinitions="Auto,*">
        <!-- Title Bar and Menu -->
        <Grid Grid.Row="0" Background="#333333" ColumnDefinitions="Auto,*">
            <!-- Menu Bar -->
            <Menu Grid.Column="0" Background="#333333" AutomationProperties.AutomationId="MainMenu">
            <MenuItem Header="_File" AutomationProperties.AutomationId="FileMenu">
                <MenuItem Header="_Open Repository..." Command="{Binding OpenRepositoryCommand}"
                          AutomationProperties.AutomationId="OpenRepositoryMenuItem" />
                <Separator />
                <MenuItem Header="_Close Repository" Command="{Binding CloseRepositoryCommand}"
                          IsEnabled="{Binding IsRepositoryOpen}"
                          AutomationProperties.AutomationId="CloseRepositoryMenuItem" />
                <Separator />
                <MenuItem Header="E_xit" AutomationProperties.AutomationId="ExitMenuItem" />
            </MenuItem>
            <MenuItem Header="_Task" AutomationProperties.AutomationId="TaskMenu">
                <MenuItem Header="_New Task..." Command="{Binding CreateTaskCommand}"
                          IsEnabled="{Binding IsRepositoryOpen}"
                          AutomationProperties.AutomationId="NewTaskMenuItem" />
                <Separator />
                <MenuItem Header="_Refresh Worktrees" Command="{Binding RefreshWorktreesCommand}"
                          IsEnabled="{Binding IsRepositoryOpen}"
                          AutomationProperties.AutomationId="RefreshWorktreesMenuItem" />
                <MenuItem Header="_Push All Branches" Command="{Binding PushAllBranchesCommand}"
                          IsEnabled="{Binding IsRepositoryOpen}"
                          AutomationProperties.AutomationId="PushAllBranchesMenuItem" />
            </MenuItem>
            <MenuItem Header="_View" AutomationProperties.AutomationId="ViewMenu">
                <MenuItem Header="_Worktrees" AutomationProperties.AutomationId="WorktreesMenuItem" />
                <MenuItem Header="_Explorer" AutomationProperties.AutomationId="ExplorerMenuItem" />
                <Separator />
                <MenuItem Header="Split All Tabs _Vertically" Command="{Binding SplitVerticalCommand}"
                          AutomationProperties.AutomationId="SplitVerticalMenuItem" />
                <MenuItem Header="Split All Tabs _Horizontally" Command="{Binding SplitHorizontalCommand}"
                          AutomationProperties.AutomationId="SplitHorizontalMenuItem" />
                <MenuItem Header="Split All Tabs in _Grid" Command="{Binding SplitGridCommand}"
                          AutomationProperties.AutomationId="SplitGridMenuItem" />
                <MenuItem Header="_Collapse Split Tabs" Command="{Binding CollapseSplitCommand}"
                          AutomationProperties.AutomationId="CollapseSplitMenuItem" />
                <Separator />
                <MenuItem Header="Auto-Split _Vertically" Command="{Binding AutoSplitVerticalCommand}"
                          AutomationProperties.AutomationId="AutoSplitVerticalMenuItem" />
                <MenuItem Header="Auto-Split H_orizontally" Command="{Binding AutoSplitHorizontalCommand}"
                          AutomationProperties.AutomationId="AutoSplitHorizontalMenuItem" />
                <MenuItem Header="Auto-Split G_rid" Command="{Binding AutoSplitGridCommand}"
                          AutomationProperties.AutomationId="AutoSplitGridMenuItem" />
                <MenuItem Header="_Disable Auto-Split" Command="{Binding DisableAutoSplitCommand}"
                          AutomationProperties.AutomationId="DisableAutoSplitMenuItem" />
                <Separator />
                <MenuItem Header="_Reset to Default View" Command="{Binding ResetViewCommand}"
                          AutomationProperties.AutomationId="ResetViewMenuItem" />
            </MenuItem>
            <MenuItem Header="_Help" AutomationProperties.AutomationId="HelpMenu">
                <MenuItem Header="_About" Command="{Binding ShowAboutCommand}"
                          AutomationProperties.AutomationId="AboutMenuItem" />
            </MenuItem>
        </Menu>

            <!-- Window Title Display -->
            <TextBlock Grid.Column="1"
                       Text="{Binding WindowTitle}"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center"
                       Foreground="#999999"
                       FontSize="13"
                       Margin="0,0,100,0" />
        </Grid>

        <!-- Dock Control -->
        <dock:DockControl Grid.Row="1"
                          Layout="{Binding Layout}"
                          InitializeLayout="True" />
    </Grid>
</Window>
