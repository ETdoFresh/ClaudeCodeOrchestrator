<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:ClaudeCodeOrchestrator.App.Views.Controls"
        x:Class="ClaudeCodeOrchestrator.App.Views.Dialogs.NewTaskDialog"
        Title="New Task"
        Width="500" MinHeight="220"
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        ShowInTaskbar="False"
        Background="#2D2D30"
        AutomationProperties.AutomationId="NewTaskDialog">

    <Grid RowDefinitions="*,Auto" Margin="20">
        <StackPanel Grid.Row="0" Spacing="12">
            <TextBlock Text="Describe the task you want Claude to work on:"
                       Foreground="#CCCCCC" FontSize="13" />
            <TextBox x:Name="TaskDescriptionBox"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     Height="80"
                     Watermark="e.g., Add user authentication with JWT tokens..."
                     Background="#3C3C3C"
                     Foreground="#CCCCCC"
                     BorderBrush="#3F3F46"
                     CaretBrush="#CCCCCC"
                     AutomationProperties.AutomationId="TaskDescriptionInput" />

            <!-- Image attachments area -->
            <Border x:Name="AttachmentsArea"
                    IsVisible="False"
                    Background="#252526"
                    CornerRadius="4"
                    Padding="8">
                <StackPanel>
                    <TextBlock Text="Attached Images:"
                               FontSize="11"
                               Foreground="#858585"
                               Margin="0,0,0,4" />
                    <ItemsControl x:Name="AttachmentsPanel">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Attach button and hint -->
            <StackPanel Orientation="Horizontal" Spacing="8">
                <Button x:Name="AttachButton"
                        Content="Attach Image"
                        Click="AttachButton_Click"
                        Background="#3C3C3C"
                        Foreground="#CCCCCC"
                        Padding="8,4"
                        FontSize="12" />
                <TextBlock Text="or paste from clipboard (âŒ˜V / Ctrl+V)"
                           FontSize="11"
                           Foreground="#666666"
                           VerticalAlignment="Center" />
            </StackPanel>

            <!-- Generated title and branch preview -->
            <Border x:Name="GeneratedPreviewArea"
                    IsVisible="False"
                    Background="#252526"
                    CornerRadius="4"
                    Padding="12"
                    Margin="0,4,0,0">
                <StackPanel Spacing="8">
                    <StackPanel Spacing="4">
                        <TextBlock Text="Title:"
                                   FontSize="11"
                                   Foreground="#858585" />
                        <TextBox x:Name="GeneratedTitleBox"
                                 Background="#3C3C3C"
                                 Foreground="#CCCCCC"
                                 BorderBrush="#3F3F46"
                                 CaretBrush="#CCCCCC"
                                 FontSize="13"
                                 Padding="8,6"
                                 AutomationProperties.AutomationId="GeneratedTitleInput" />
                    </StackPanel>
                    <StackPanel Spacing="4">
                        <TextBlock Text="Branch:"
                                   FontSize="11"
                                   Foreground="#858585" />
                        <TextBox x:Name="GeneratedBranchBox"
                                 Background="#3C3C3C"
                                 Foreground="#9CDCFE"
                                 BorderBrush="#3F3F46"
                                 CaretBrush="#CCCCCC"
                                 FontSize="12"
                                 FontFamily="Consolas, Menlo, monospace"
                                 Padding="8,6"
                                 AutomationProperties.AutomationId="GeneratedBranchInput" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Generating indicator -->
            <StackPanel x:Name="GeneratingIndicator"
                        IsVisible="False"
                        Orientation="Horizontal"
                        Spacing="8">
                <TextBlock Text="Generating title..."
                           FontSize="12"
                           Foreground="#858585"
                           FontStyle="Italic" />
            </StackPanel>

            <TextBlock x:Name="ErrorText"
                       Foreground="#F44747"
                       FontSize="12"
                       IsVisible="False"
                       AutomationProperties.AutomationId="TaskErrorText" />
        </StackPanel>

        <StackPanel Grid.Row="1" Orientation="Horizontal"
                    HorizontalAlignment="Right" Spacing="8" Margin="0,16,0,0">
            <Button Content="Cancel" Click="Cancel_Click" Width="80"
                    Background="#3C3C3C" Foreground="#CCCCCC"
                    AutomationProperties.AutomationId="TaskCancelButton" />
            <Button x:Name="GenerateButton" Content="Generate" Click="Generate_Click" Width="80"
                    Background="#3C3C3C" Foreground="#CCCCCC"
                    AutomationProperties.AutomationId="TaskGenerateButton" />
            <Button x:Name="CreateButton" Content="Create" Click="Create_Click" Width="80"
                    Background="#0E639C" Foreground="White"
                    IsEnabled="False"
                    AutomationProperties.AutomationId="TaskCreateButton" />
        </StackPanel>
    </Grid>
</Window>
